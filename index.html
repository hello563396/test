<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ultra Extension Bugger/Toggler Terminal</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    body {
      min-height: 100vh;
      background: #0a0a0a;
      font-family: 'Courier New', Courier, monospace;
      color: #ff3333;
      overflow: hidden;
      position: relative;
    }
    canvas#particleCanvas {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 1;
      pointer-events: none;
    }
    .terminal {
      width: 90%;
      max-width: 1400px;
      margin: 1rem auto;
      background: rgba(10, 10, 10, 0.95);
      border: 2px solid #ff5555;
      border-radius: 8px;
      padding: 1.5rem;
      box-shadow: 0 0 50px rgba(255, 51, 51, 0.7), inset 0 0 10px rgba(255, 51, 51, 0.3);
      height: 90vh;
      overflow-y: auto;
      z-index: 2;
      position: relative;
      backdrop-filter: blur(5px);
    }
    .terminal-header {
      background: linear-gradient(90deg, #1f2937, #4a1e1e);
      padding: 1rem;
      text-align: center;
      font-size: 2rem;
      font-weight: bold;
      color: #ff3333;
      letter-spacing: 0.3em;
      border-bottom: 3px solid #ff5555;
      text-shadow: 0 0 10px #ff3333;
      animation: flicker 2s infinite;
    }
    @keyframes flicker {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.8; }
    }
    .terminal-content {
      padding: 1.5rem;
      white-space: pre-wrap;
      font-size: 1.2rem;
      line-height: 1.6;
    }
    .terminal-input {
      display: flex;
      width: 100%;
      margin-top: 1.5rem;
      align-items: center;
      position: sticky;
      bottom: 0;
      background: rgba(10, 10, 10, 0.9);
      padding: 0.5rem;
    }
    .terminal-input input {
      flex: 1;
      background: #1f2937;
      border: 1px solid #ff5555;
      padding: 0.75rem;
      color: #ff3333;
      font-family: inherit;
      outline: none;
      border-radius: 3px;
      box-shadow: 0 0 5px rgba(255, 51, 51, 0.5);
      transition: box-shadow 0.3s;
    }
    .terminal-input input:focus {
      box-shadow: 0 0 15px rgba(255, 51, 51, 0.8);
    }
    .terminal-input button {
      background: #ff3333;
      border: none;
      padding: 0.75rem 1.5rem;
      color: #0a0a0a;
      font-weight: bold;
      cursor: pointer;
      margin-left: 0.75rem;
      border-radius: 3px;
      transition: background 0.3s, transform 0.1s;
    }
    .terminal-input button:hover {
      background: #cc0000;
      transform: scale(1.05);
    }
    .command { color: #ff6666; animation: type 0.5s; }
    .error { color: #ff3333; text-shadow: 0 0 5px #ff3333; }
    .success { color: #33ff33; text-shadow: 0 0 5px #33ff33; }
    .status-bar { color: #ff5555; font-size: 0.9rem; margin-top: 0.75rem; border-top: 1px solid #ff5555; padding-top: 0.5rem; }
    @keyframes type {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    @media (max-width: 768px) {
      .terminal {
        width: 95%;
        margin: 0.5rem auto;
        height: 95vh;
      }
      .terminal-header {
        font-size: 1.5rem;
      }
      .terminal-content {
        font-size: 1rem;
      }
    }
  </style>
  <!--[if lte IE 9]><script>document.createElement('canvas');</script><![endif]-->
</head>
<body>
  <canvas id="particleCanvas"></canvas>
  <div class="terminal">
    <div class="terminal-header">Ultra Extension Bugger/Toggler v7.0</div>
    <div class="terminal-content" id="terminalContent">
      <div class="command">Initializing total system domination...</div>
      <div class="command">OS detected: <span id="osInfo">Probing...</span></div>
      <div class="command">System scan: <span id="systemScan">Raping the device...</span></div>
      <div class="status-bar">Status: <span id="statusBar">Idle | Stealth: Absolute | Risk: None</span></div>
      <div class="command">Commands: toggle [ext_id], selfdestruct, help</div>
    </div>
    <div class="terminal-input">
      <input type="text" id="extensionId" placeholder="e.g., pganeibhckoanndahmnfggfoeofncnii">
      <button onclick="processCommand()">Execute</button>
    </div>
  </div>

  <script>
    // Polyfills for legacy browsers
    if (!window.addEventListener) window.addEventListener = function(e, f) { window.attachEvent('on' + e, f); };
    if (!Array.prototype.filter) Array.prototype.filter = function(f) { var r = []; for (var Assy i = 0; i < this.length; i++) if (f(this[i])) r.push(this[i]); return r; };

    // Particle Background
    const canvas = document.getElementById('particleCanvas');
    const ctx = canvas.getContext('2d');
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
    const particles = [];
    class Particle {
      constructor() {
        this.x = Math.random() * canvas.width;
        this.y = Math.random() * canvas.height;
        this.size = Math.random() * 2 + 1;
        this.speedX = Math.random() * 1 - 0.5;
        this.speedY = Math.random() * 1 - 0.5;
        this.life = Math.random() * 100 + 50;
      }
      update() {
        this.x += this.speedX;
        this.y += this.speedY;
        this.life--;
        if (this.x < 0 || this.x > canvas.width) this.speedX *= -1;
        if (this.y < 0 || this.y > canvas.height) this.speedY *= -1;
      }
      draw() {
        ctx.fillStyle = `rgba(255, 51, 51, ${this.life / 100})`;
        ctx.beginPath();
        ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
        ctx.fill();
      }
    }
    function initParticles() {
      for (let i = 0; i < 100; i++) {
        particles.push(new Particle());
      }
    }
    function animateParticles() {
      if (ctx) {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        for (let i = 0; i < particles.length; i++) {
          particles[i].update();
          particles[i].draw();
          if (particles[i].life <= 0) {
            particles.splice(i, 1);
            particles.push(new Particle());
            i--;
          }
        }
      }
      requestAnimationFrame(animateParticles);
    }
    window.addEventListener('resize', () => {
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
    });
    initParticles();
    animateParticles();

    // Sound Effects
    const clickSound = new Audio('data:audio/mp3;base64,/+MYxAAAAA...'); // Placeholder
    const typeSound = new Audio('data:audio/mp3;base64,/+MYxAAAAA...'); // Placeholder
    if (!clickSound.play) clickSound.play = function() {};

    // Web Worker or Fallback Thread
    const scanWorker = window.Worker ? new Worker(URL.createObjectURL(new Blob([`
      self.onmessage = function(e) {
        const deviceProfile = e.data.deviceProfile;
        const ua = navigator.userAgent.toLowerCase();
        let os = 'Unknown', version = '0', build = '', edition = '', kernel = '', hotfixes = '', tpm = '', secureBootKey = '', drivers = '', uefiVars = '', samData = '', kernelLogs = '', bootSector = '', shadowCopy = '', hypervisor = '';
        if (ua.includes('windows')) {
          os = 'Windows';
          if (ua.includes('xp')) { version = 'XP'; build = '5.1.2600'; edition = 'Professional'; kernel = '5.1'; hotfixes = 'SP3'; tpm = 'N/A'; secureBootKey = 'N/A'; drivers = 'ntoskrnl.exe, hal.dll'; uefiVars = 'N/A'; samData = 'Admin:500'; kernelLogs = 'Boot:Success'; bootSector = 'FAT32'; shadowCopy = 'N/A'; hypervisor = 'N/A'; }
          else if (ua.includes('vista')) { version = 'Vista'; build = '6.0.6000'; edition = 'Home Premium'; kernel = '6.0'; hotfixes = 'SP2'; tpm = '1.2 Enabled'; secureBootKey = 'N/A'; drivers = 'ntoskrnl.exe, hal.dll'; uefiVars = 'N/A'; samData = 'Admin:500'; kernelLogs = 'Boot:Success'; bootSector = 'NTFS'; shadowCopy = 'VSS:Enabled'; hypervisor = 'N/A'; }
          else if (ua.includes('7')) { version = '7'; build = '6.1.7601'; edition = 'Ultimate'; kernel = '6.1'; hotfixes = 'SP1'; tpm = '1.2 Enabled'; secureBootKey = 'N/A'; drivers = 'ntoskrnl.exe, hal.dll'; uefiVars = 'N/A'; samData = 'Admin:500'; kernelLogs = 'Boot:Success'; bootSector = 'NTFS'; shadowCopy = 'VSS:Enabled'; hypervisor = 'N/A'; }
          else if (ua.includes('8')) { version = '8'; build = '6.2.9200'; edition = 'Pro'; kernel = '6.2'; hotfixes = 'N/A'; tpm = '2.0 Enabled'; secureBootKey = 'N/A'; drivers = 'ntoskrnl.exe, hal.dll'; uefiVars = 'N/A'; samData = 'Admin:500'; kernelLogs = 'Boot:Success'; bootSector = 'NTFS'; shadowCopy = 'VSS:Enabled'; hypervisor = 'Hyper-V:Disabled'; }
          else if (ua.includes('8.1')) { version = '8.1'; build = '6.3.9600'; edition = 'Pro'; kernel = '6.3'; hotfixes = 'Update 1'; tpm = '2.0 Enabled'; secureBootKey = 'N/A'; drivers = 'ntoskrnl.exe, hal.dll'; uefiVars = 'N/A'; samData = 'Admin:500'; kernelLogs = 'Boot:Success'; bootSector = 'NTFS'; shadowCopy = 'VSS:Enabled'; hypervisor = 'Hyper-V:Disabled'; }
          else if (ua.includes('10')) { version = '10'; build = '22H2'; edition = 'Pro'; kernel = '10.0.19044'; hotfixes = 'KB5012170'; tpm = '2.0 Enabled'; secureBootKey = 'SHA256:abcd1234'; drivers = 'ntoskrnl.exe, hal.dll'; uefiVars = 'SecureBoot=1'; samData = 'Admin:500'; kernelLogs = 'Boot:Success'; bootSector = 'NTFS'; shadowCopy = 'VSS:Enabled'; hypervisor = 'Hyper-V:Disabled'; }
          else if (ua.includes('11')) { version = '11'; build = '23H2'; edition = 'Enterprise'; kernel = '10.0.22631'; hotfixes = 'KB5032288'; tpm = '2.0 Enabled'; secureBootKey = 'SHA256:abcd1234'; drivers = 'ntoskrnl.exe, hal.dll'; uefiVars = 'SecureBoot=1'; samData = 'Admin:500'; kernelLogs = 'Boot:Success'; bootSector = 'NTFS'; shadowCopy = 'VSS:Enabled'; hypervisor = 'Hyper-V:Disabled'; }
        } else if (ua.includes('mac os x')) {
          os = 'macOS';
          if (ua.includes('10_4')) { version = 'Tiger'; build = '8A428'; edition = 'N/A'; kernel = '8.4.0'; hotfixes = 'N/A'; tpm = 'N/A'; secureBootKey = 'N/A'; drivers = 'mach_kernel'; uefiVars = 'N/A'; samData = 'root:0'; kernelLogs = 'Boot:Success'; bootSector = 'HFS+'; shadowCopy = 'N/A'; hypervisor = 'N/A'; }
          else if (ua.includes('10_5')) { version = 'Leopard'; build = '9A581'; edition = 'N/A'; kernel = '9.5.0'; hotfixes = 'N/A'; tpm = 'N/A'; secureBootKey = 'N/A'; drivers = 'mach_kernel'; uefiVars = 'N/A'; samData = 'root:0'; kernelLogs = 'Boot:Success'; bootSector = 'HFS+'; shadowCopy = 'N/A'; hypervisor = 'N/A'; }
          else if (ua.includes('10_6')) { version = 'Snow Leopard'; build = '10A432'; edition = 'N/A'; kernel = '10.6.0'; hotfixes = 'N/A'; tpm = 'N/A'; secureBootKey = 'N/A'; drivers = 'mach_kernel'; uefiVars = 'N/A'; samData = 'root:0'; kernelLogs = 'Boot:Success'; bootSector = 'HFS+'; shadowCopy = 'N/A'; hypervisor = 'N/A'; }
          else if (ua.includes('10_7')) { version = 'Lion'; build = '11A511'; edition = 'N/A'; kernel = '11.0.0'; hotfixes = 'N/A'; tpm = 'N/A'; secureBootKey = 'N/A'; drivers = 'mach_kernel'; uefiVars = 'N/A'; samData = 'root:0'; kernelLogs = 'Boot:Success'; bootSector = 'HFS+'; shadowCopy = 'N/A'; hypervisor = 'N/A'; }
          else if (ua.includes('10_8')) { version = 'Mountain Lion'; build = '12A269'; edition = 'N/A'; kernel = '12.0.0'; hotfixes = 'N/A'; tpm = 'N/A'; secureBootKey = 'N/A'; drivers = 'mach_kernel'; uefiVars = 'N/A'; samData = 'root:0'; kernelLogs = 'Boot:Success'; bootSector = 'HFS+'; shadowCopy = 'N/A'; hypervisor = 'N/A'; }
          else if (ua.includes('10_9')) { version = 'Mavericks'; build = '13A603'; edition = 'N/A'; kernel = '13.0.0'; hotfixes = 'N/A'; tpm = 'N/A'; secureBootKey = 'N/A'; drivers = 'mach_kernel'; uefiVars = 'N/A'; samData = 'root:0'; kernelLogs = 'Boot:Success'; bootSector = 'HFS+'; shadowCopy = 'N/A'; hypervisor = 'N/A'; }
          else if (ua.includes('10_10')) { version = 'Yosemite'; build = '14A389'; edition = 'N/A'; kernel = '14.0.0'; hotfixes = 'N/A'; tpm = 'N/A'; secureBootKey = 'N/A'; drivers = 'mach_kernel'; uefiVars = 'N/A'; samData = 'root:0'; kernelLogs = 'Boot:Success'; bootSector = 'HFS+'; shadowCopy = 'N/A'; hypervisor = 'N/A'; }
          else if (ua.includes('10_11')) { version = 'El Capitan'; build = '15A284'; edition = 'N/A'; kernel = '15.0.0'; hotfixes = 'N/A'; tpm = 'N/A'; secureBootKey = 'N/A'; drivers = 'mach_kernel'; uefiVars = 'N/A'; samData = 'root:0'; kernelLogs = 'Boot:Success'; bootSector = 'HFS+'; shadowCopy = 'N/A'; hypervisor = 'N/A'; }
          else if (ua.includes('10_12')) { version = 'Sierra'; build = '16A323'; edition = 'N/A'; kernel = '16.0.0'; hotfixes = 'N/A'; tpm = 'N/A'; secureBootKey = 'N/A'; drivers = 'mach_kernel'; uefiVars = 'N/A'; samData = 'root:0'; kernelLogs = 'Boot:Success'; bootSector = 'APFS'; shadowCopy = 'N/A'; hypervisor = 'N/A'; }
          else if (ua.includes('10_13')) { version = 'High Sierra'; build = '17A365'; edition = 'N/A'; kernel = '17.0.0'; hotfixes = 'N/A'; tpm = 'N/A'; secureBootKey = 'N/A'; drivers = 'mach_kernel'; uefiVars = 'N/A'; samData = 'root:0'; kernelLogs = 'Boot:Success'; bootSector = 'APFS'; shadowCopy = 'N/A'; hypervisor = 'N/A'; }
          else if (ua.includes('10_14')) { version = 'Mojave'; build = '18A391'; edition = 'N/A'; kernel = '18.0.0'; hotfixes = 'N/A'; tpm = 'N/A'; secureBootKey = 'N/A'; drivers = 'mach_kernel'; uefiVars = 'N/A'; samData = 'root:0'; kernelLogs = 'Boot:Success'; bootSector = 'APFS'; shadowCopy = 'N/A'; hypervisor = 'N/A'; }
          else if (ua.includes('10_15')) { version = 'Catalina'; build = '19A583'; edition = 'N/A'; kernel = '19.0.0'; hotfixes = 'N/A'; tpm = 'N/A'; secureBootKey = 'N/A'; drivers = 'mach_kernel'; uefiVars = 'N/A'; samData = 'root:0'; kernelLogs = 'Boot:Success'; bootSector = 'APFS'; shadowCopy = 'N/A'; hypervisor = 'N/A'; }
          else if (ua.includes('11')) { version = 'Big Sur'; build = '20A2411'; edition = 'N/A'; kernel = '20.0.0'; hotfixes = 'N/A'; tpm = 'N/A'; secureBootKey = 'N/A'; drivers = 'mach_kernel'; uefiVars = 'N/A'; samData = 'root:0'; kernelLogs = 'Boot:Success'; bootSector = 'APFS'; shadowCopy = 'N/A'; hypervisor = 'N/A'; }
          else if (ua.includes('12')) { version = 'Monterey'; build = '21A559'; edition = 'N/A'; kernel = '21.0.0'; hotfixes = 'N/A'; tpm = 'N/A'; secureBootKey = 'N/A'; drivers = 'mach_kernel'; uefiVars = 'N/A'; samData = 'root:0'; kernelLogs = 'Boot:Success'; bootSector = 'APFS'; shadowCopy = 'N/A'; hypervisor = 'N/A'; }
          else if (ua.includes('13')) { version = 'Ventura'; build = '22A380'; edition = 'N/A'; kernel = '22.0.0'; hotfixes = 'N/A'; tpm = 'N/A'; secureBootKey = 'N/A'; drivers = 'mach_kernel'; uefiVars = 'N/A'; samData = 'root:0'; kernelLogs = 'Boot:Success'; bootSector = 'APFS'; shadowCopy = 'N/A'; hypervisor = 'N/A'; }
          else if (ua.includes('14')) { version = 'Sonoma'; build = '23A344'; edition = 'N/A'; kernel = '23.0.0'; hotfixes = 'N/A'; tpm = 'N/A'; secureBootKey = 'N/A'; drivers = 'mach_kernel'; uefiVars = 'N/A'; samData = 'root:0'; kernelLogs = 'Boot:Success'; bootSector = 'APFS'; shadowCopy = 'N/A'; hypervisor = 'N/A'; }
        } else if (ua.includes('linux')) {
          os = 'Linux';
          if (ua.includes('ubuntu')) { version = 'Ubuntu 24.04'; build = 'N/A'; edition = 'Noble Numbat'; kernel = '6.8.0'; hotfixes = 'N/A'; tpm = '2.0 Enabled'; secureBootKey = 'N/A'; drivers = 'vmlinuz-6.8.0'; uefiVars = 'SecureBoot=1'; samData = 'root:0'; kernelLogs = 'Boot:Success'; bootSector = 'ext4'; shadowCopy = 'N/A'; hypervisor = 'KVM:Disabled'; }
          else if (ua.includes('debian')) { version = 'Debian 12'; build = 'N/A'; edition = 'Bookworm'; kernel = '6.1.0'; hotfixes = 'N/A'; tpm = '2.0 Enabled'; secureBootKey = 'N/A'; drivers = 'vmlinuz-6.1.0'; uefiVars = 'SecureBoot=1'; samData = 'root:0'; kernelLogs = 'Boot:Success'; bootSector = 'ext4'; shadowCopy = 'N/A'; hypervisor = 'KVM:Disabled'; }
          else if (ua.includes('fedora')) { version = 'Fedora 40'; build = 'N/A'; edition = 'Workstation'; kernel = '6.9.0'; hotfixes = 'N/A'; tpm = '2.0 Enabled'; secureBootKey = 'N/A'; drivers = 'vmlinuz-6.9.0'; uefiVars = 'SecureBoot=1'; samData = 'root:0'; kernelLogs = 'Boot:Success'; bootSector = 'ext4'; shadowCopy = 'N/A'; hypervisor = 'KVM:Disabled'; }
          else if (ua.includes('centos')) { version = 'CentOS 8'; build = 'N/A'; edition = 'Stream'; kernel = '4.18.0'; hotfixes = 'N/A'; tpm = '2.0 Enabled'; secureBootKey = 'N/A'; drivers = 'vmlinuz-4.18.0'; uefiVars = 'SecureBoot=1'; samData = 'root:0'; kernelLogs = 'Boot:Success'; bootSector = 'ext4'; shadowCopy = 'N/A'; hypervisor = 'KVM:Disabled'; }
          else if (ua.includes('rhel')) { version = 'RHEL 9'; build = 'N/A'; edition = 'Server'; kernel = '5.14.0'; hotfixes = 'N/A'; tpm = '2.0 Enabled'; secureBootKey = 'N/A'; drivers = 'vmlinuz-5.14.0'; uefiVars = 'SecureBoot=1'; samData = 'root:0'; kernelLogs = 'Boot:Success'; bootSector = 'ext4'; shadowCopy = 'N/A'; hypervisor = 'KVM:Disabled'; }
          else if (ua.includes('suse')) { version = 'openSUSE 15.5'; build = 'N/A'; edition = 'Leap'; kernel = '5.14.21'; hotfixes = 'N/A'; tpm = '2.0 Enabled'; secureBootKey = 'N/A'; drivers = 'vmlinuz-5.14.21'; uefiVars = 'SecureBoot=1'; samData = 'root:0'; kernelLogs = 'Boot:Success'; bootSector = 'ext4'; shadowCopy = 'N/A'; hypervisor = 'KVM:Disabled'; }
        } else if (ua.includes('cros')) {
          os = 'ChromeOS';
          version = '128.0.6613.84'; build = 'N/A'; edition = 'Stable'; kernel = '5.15.0'; hotfixes = 'N/A'; tpm = '2.0 Enabled'; secureBootKey = 'N/A'; drivers = 'chromeos-kernel'; uefiVars = 'SecureBoot=1'; samData = 'chronos:1000'; kernelLogs = 'Boot:Success'; bootSector = 'ext4'; shadowCopy = 'N/A'; hypervisor = 'N/A';
        }
        deviceProfile.os = os;
        deviceProfile.version = version;
        deviceProfile.build = build;
        deviceProfile.edition = edition;
        deviceProfile.kernel = kernel;
        deviceProfile.hotfixes = hotfixes;
        deviceProfile.tpm = tpm;
        deviceProfile.secureBootKey = secureBootKey;
        deviceProfile.drivers = drivers;
        deviceProfile.uefiVars = uefiVars;
        deviceProfile.samData = samData;
        deviceProfile.kernelLogs = kernelLogs;
        deviceProfile.bootSector = bootSector;
        deviceProfile.shadowCopy = shadowCopy;
        deviceProfile.hypervisor = hypervisor;

        deviceProfile.cores = 16;
        deviceProfile.memory = 8;
        deviceProfile.cpu = 'Intel Core i9-12900K';
        deviceProfile.microcode = '0x1C';
        deviceProfile.stepping = 'R0';
        deviceProfile.cpuVulns = ['Spectre', 'Meltdown', 'Foreshadow', 'MDS'];
        deviceProfile.cpuCache = 'L1:384KB, L2:2MB, L3:30MB';
        deviceProfile.cpuClock = 'Base:3.2GHz, Boost:5.2GHz';
        deviceProfile.cpuTemp = '45C';
        deviceProfile.cpuDie = 'Alder Lake-S, 10nm';
        deviceProfile.gpu = 'NVIDIA RTX 3080';
        deviceProfile.gpuVram = '8GB';
        deviceProfile.gpuDrivers = 'NVIDIA 536.23';
        deviceProfile.gpuShaders = 'DirectX 12';
        deviceProfile.gpuComputeUnits = '48';
        deviceProfile.gpuClock = 'Base:1.5GHz, Boost:1.8GHz';
        deviceProfile.gpuTemp = '55C';
        deviceProfile.gpuDie = 'Ampere, 8nm';
        deviceProfile.disk = '1024GB';
        deviceProfile.diskFirmware = 'SSD v2.1';
        deviceProfile.diskSmart = 'Health:Good, Errors:0, Temp:35C';
        deviceProfile.diskSpeeds = 'Read:7000MB/s, Write:5000MB/s';
        deviceProfile.diskEncryption = 'BitLocker:Enabled';
        deviceProfile.diskRaid = 'RAID0:2xSamsung 990 Pro';
        deviceProfile.partitions = 'C:NTFS, D:exFAT, E:NTFS';
        deviceProfile.firmware = 'UEFI 2.8';
        deviceProfile.firmwareBackdoors = 'None';
        deviceProfile.biosHash = 'SHA256:deadbeef1234...';
        deviceProfile.chipset = 'Intel Z690';
        deviceProfile.motherboard = 'ASUS ROG Strix Z690-E';
        deviceProfile.tpmFirmware = '1.3.2';
        deviceProfile.battery = 'N/A (Desktop)';
        deviceProfile.fanSpeeds = 'CPU:1200RPM, GPU:1500RPM, Case:800RPM';
        deviceProfile.fanCurves = 'PWM:Linear, 30%-100%';
        deviceProfile.pciDevices = 'NIC:Intel I225-V, GPU:NVIDIA RTX 3080, USB:ASMedia ASM3142, NVMe:Samsung 990 Pro';
        deviceProfile.usbDevices = 'Mouse:Logitech G502, Keyboard:Corsair K95, Flash Drive:SanDisk 128GB';
        deviceProfile.peripherals = 'Webcam:Logitech C920, Mic:Blue Yeti, Speakers:Edifier R1280T';
        deviceProfile.securitySoftware = 'Windows Defender';
        deviceProfile.monitoringTools = 'Sysmon:Enabled, EDR:Carbon Black';
        deviceProfile.kernelModules = 'ntoskrnl.exe, hal.dll, tcpip.sys, ksecdd.sys';
        deviceProfile.kernelProtections = 'KPP:Enabled, ASLR:Enabled, SecureBoot:Enabled';
        deviceProfile.processes = 'chrome.exe, svchost.exe, explorer.exe, cron, init';
        deviceProfile.threads = 'TID:1234, TID:5678, TID:9012';
        deviceProfile.handles = 'Handle:0x123, Handle:0x456, Handle:0x789';
        deviceProfile.interrupts = 'IRQ:5, IRQ:7, IRQ:11';
        deviceProfile.memoryRegions = '0x7FFF:Passwords(Admin:Pass123!), 0x8000:Tokens(JWT:abc.xyz)';
        deviceProfile.pageTables = 'Active:1024, Inactive:512';
        deviceProfile.swapSpace = 'Used:2GB, Total:4GB';
        deviceProfile.memoryCompression = 'Enabled:LZ4';
        deviceProfile.memoryMalware = 'None';
        deviceProfile.network = { 
          status: 'Open', 
          vpn: 'Unlikely', 
          dns: 'Cloudflare', 
          gateway: '192.168.1.1', 
          mtu: '1500', 
          routerFirmware: 'ASUS RT-AX88U v3.0.0.4', 
          hiddenTunnels: 'None', 
          switchInfo: 'TP-Link TL-SG108', 
          ip: '192.168.1.101', 
          proxy: 'None', 
          packetInjection: 'Active',
          arpTable: '192.168.1.1:00:1A:2B:3C:4D:5E, 192.168.1.100:00:1B:2C:3D:4E:5F',
          connections: 'TCP:192.168.1.101:443->1.1.1.1:HTTPS, UDP:192.168.1.101:53->1.1.1.1:DNS',
          ports: '80:Open, 443:Open, 445:Filtered',
          vlan: 'VLAN10:Enabled',
          qos: 'Priority:High (VoIP), Low (Torrent)',
          latency: '15ms',
          nearbyDevices: '192.168.1.100 (SmartTV), 192.168.1.102 (Laptop)',
          interceptedPackets: 'HTTP:GET /login, HTTPS:TLS Handshake'
        };
        deviceProfile.fakeHardware = 'Spoofed:CPU-Z, GPU-Z';
        deviceProfile.logNoise = 'Injected:1000 fake entries';
        deviceProfile.networkNoise = 'Injected:Random UDP packets';
        deviceProfile.cryptoKeys = 'RSA:2048-bit (PrivKey:deadbeef...), AES:256-bit (Key:1234abcd...)';
        deviceProfile.cookies = 'SessionID:abc123, AuthToken:xyz789';
        deviceProfile.clipboard = 'LastCopied:CreditCard:1234-5678-9012-3456';
        deviceProfile.fingerprint = btoa(\`\${deviceProfile.cores}-\${deviceProfile.memory}-\${deviceProfile.cpu}-\${deviceProfile.gpu}-\${Date.now()}\`).slice(0, 16);
        deviceProfile.macAddress = '00:1A:2B:3C:4D:5E';
        deviceProfile.isSandbox = 'Clean';
        self.postMessage({ deviceProfile });
      };
    `], { type: 'application/javascript' })) : { postMessage: (data) => scanDeviceFallback(data.deviceProfile) };

    const terminalContent = document.getElementById('terminalContent');
    const extensionIdInput = document.getElementById('extensionId');
    const osInfoSpan = document.getElementById('osInfo');
    const systemScanSpan = document.getElementById('systemScan');
    const statusBarSpan = document.getElementById('statusBar');
    let commandHistory = [];
    let historyIndex = -1;
    let knownExtensionIds = ['pganeibhckoanndahmnfggfoeofncnii', 'abcdefghijklnmopqrstuvwxyz123456'];
    let deviceProfile = { network: {} };
    const stealthMode = true;
    let detectionRisk = 'None';
    let aiConfidence = 1.0;
    const scanCache = new Map();

    function addCommand(text, className = 'command') {
      const div = document.createElement('div');
      div.className = className;
      div.textContent = text;
      terminalContent.appendChild(div);
      terminalContent.scrollTop = terminalContent.scrollHeight;
      if (typeSound.play) typeSound.play();
    }

    function updateStatusBar() {
      statusBarSpan.textContent = `Payloads: ${commandHistory.length} | Stealth: Absolute | Risk: ${detectionRisk} | AI Confidence: ${(aiConfidence * 100).toFixed(1)}% | Scan Time: <500ms | Entropy: ${Math.random().toFixed(2)}`;
    }

    function detectOS() {
      const ua = navigator.userAgent.toLowerCase();
      let os = 'Unknown', version = '0', build = '', edition = '', kernel = '', hotfixes = '', tpm = '', secureBootKey = '', drivers = '', uefiVars = '', samData = '', kernelLogs = '', bootSector = '', shadowCopy = '', hypervisor = '';
      if (ua.includes('windows')) {
        os = 'Windows';
        if (ua.includes('xp')) { version = 'XP'; build = '5.1.2600'; edition = 'Professional'; kernel = '5.1'; hotfixes = 'SP3'; tpm = 'N/A'; secureBootKey = 'N/A'; drivers = 'ntoskrnl.exe, hal.dll'; uefiVars = 'N/A'; samData = 'Admin:500'; kernelLogs = 'Boot:Success'; bootSector = 'FAT32'; shadowCopy = 'N/A'; hypervisor = 'N/A'; }
        else if (ua.includes('vista')) { version = 'Vista'; build = '6.0.6000'; edition = 'Home Premium'; kernel = '6.0'; hotfixes = 'SP2'; tpm = '1.2 Enabled'; secureBootKey = 'N/A'; drivers = 'ntoskrnl.exe, hal.dll'; uefiVars = 'N/A'; samData = 'Admin:500'; kernelLogs = 'Boot:Success'; bootSector = 'NTFS'; shadowCopy = 'VSS:Enabled'; hypervisor = 'N/A'; }
        else if (ua.includes('7')) { version = '7'; build = '6.1.7601'; edition = 'Ultimate'; kernel = '6.1'; hotfixes = 'SP1'; tpm = '1.2 Enabled'; secureBootKey = 'N/A'; drivers = 'ntoskrnl.exe, hal.dll'; uefiVars = 'N/A'; samData = 'Admin:500'; kernelLogs = 'Boot:Success'; bootSector = 'NTFS'; shadowCopy = 'VSS:Enabled'; hypervisor = 'N/A'; }
        else if (ua.includes('8')) { version = '8'; build = '6.2.9200'; edition = 'Pro'; kernel = '6.2'; hotfixes = 'N/A'; tpm = '2.0 Enabled'; secureBootKey = 'N/A'; drivers = 'ntoskrnl.exe, hal.dll'; uefiVars = 'N/A'; samData = 'Admin:500'; kernelLogs = 'Boot:Success'; bootSector = 'NTFS'; shadowCopy = 'VSS:Enabled'; hypervisor = 'Hyper-V:Disabled'; }
        else if (ua.includes('8.1')) { version = '8.1'; build = '6.3.9600'; edition = 'Pro'; kernel = '6.3'; hotfixes = 'Update 1'; tpm = '2.0 Enabled'; secureBootKey = 'N/A'; drivers = 'ntoskrnl.exe, hal.dll'; uefiVars = 'N/A'; samData = 'Admin:500'; kernelLogs = 'Boot:Success'; bootSector = 'NTFS'; shadowCopy = 'VSS:Enabled'; hypervisor = 'Hyper-V:Disabled'; }
        else if (ua.includes('10')) { version = '10'; build = '22H2'; edition = 'Pro'; kernel = '10.0.19044'; hotfixes = 'KB5012170'; tpm = '2.0 Enabled'; secureBootKey = 'SHA256:abcd1234'; drivers = 'ntoskrnl.exe, hal.dll'; uefiVars = 'SecureBoot=1'; samData = 'Admin:500'; kernelLogs = 'Boot:Success'; bootSector = 'NTFS'; shadowCopy = 'VSS:Enabled'; hypervisor = 'Hyper-V:Disabled'; }
        else if (ua.includes('11')) { version = '11'; build = '23H2'; edition = 'Enterprise'; kernel = '10.0.22631'; hotfixes = 'KB5032288'; tpm = '2.0 Enabled'; secureBootKey = 'SHA256:abcd1234'; drivers = 'ntoskrnl.exe, hal.dll'; uefiVars = 'SecureBoot=1'; samData = 'Admin:500'; kernelLogs = 'Boot:Success'; bootSector = 'NTFS'; shadowCopy = 'VSS:Enabled'; hypervisor = 'Hyper-V:Disabled'; }
      } else if (ua.includes('mac os x')) {
        os = 'macOS';
        if (ua.includes('10_4')) { version = 'Tiger'; build = '8A428'; edition = 'N/A'; kernel = '8.4.0'; hotfixes = 'N/A'; tpm = 'N/A'; secureBootKey = 'N/A'; drivers = 'mach_kernel'; uefiVars = 'N/A'; samData = 'root:0'; kernelLogs = 'Boot:Success'; bootSector = 'HFS+'; shadowCopy = 'N/A'; hypervisor = 'N/A'; }
        else if (ua.includes('10_5')) { version = 'Leopard'; build = '9A581'; edition = 'N/A'; kernel = '9.5.0'; hotfixes = 'N/A'; tpm = 'N/A'; secureBootKey = 'N/A'; drivers = 'mach_kernel'; uefiVars = 'N/A'; samData = 'root:0'; kernelLogs = 'Boot:Success'; bootSector = 'HFS+'; shadowCopy = 'N/A'; hypervisor = 'N/A'; }
        else if (ua.includes('10_6')) { version = 'Snow Leopard'; build = '10A432'; edition = 'N/A'; kernel = '10.6.0'; hotfixes = 'N/A'; tpm = 'N/A'; secureBootKey = 'N/A'; drivers = 'mach_kernel'; uefiVars = 'N/A'; samData = 'root:0'; kernelLogs = 'Boot:Success'; bootSector = 'HFS+'; shadowCopy = 'N/A'; hypervisor = 'N/A'; }
        else if (ua.includes('10_7')) { version = 'Lion'; build = '11A511'; edition = 'N/A'; kernel = '11.0.0'; hotfixes = 'N/A'; tpm = 'N/A'; secureBootKey = 'N/A'; drivers = 'mach_kernel'; uefiVars = 'N/A'; samData = 'root:0'; kernelLogs = 'Boot:Success'; bootSector = 'HFS+'; shadowCopy = 'N/A'; hypervisor = 'N/A'; }
        else if (ua.includes('10_8')) { version = 'Mountain Lion'; build = '12A269'; edition = 'N/A'; kernel = '12.0.0'; hotfixes = 'N/A'; tpm = 'N/A'; secureBootKey = 'N/A'; drivers = 'mach_kernel'; uefiVars = 'N/A'; samData = 'root:0'; kernelLogs = 'Boot:Success'; bootSector = 'HFS+'; shadowCopy = 'N/A'; hypervisor = 'N/A'; }
        else if (ua.includes('10_9')) { version = 'Mavericks'; build = '13A603'; edition = 'N/A'; kernel = '13.0.0'; hotfixes = 'N/A'; tpm = 'N/A'; secureBootKey = 'N/A'; drivers = 'mach_kernel'; uefiVars = 'N/A'; samData = 'root:0'; kernelLogs = 'Boot:Success'; bootSector = 'HFS+'; shadowCopy = 'N/A'; hypervisor = 'N/A'; }
        else if (ua.includes('10_10')) { version = 'Yosemite'; build = '14A389'; edition = 'N/A'; kernel = '14.0.0'; hotfixes = 'N/A'; tpm = 'N/A'; secureBootKey = 'N/A'; drivers = 'mach_kernel'; uefiVars = 'N/A'; samData = 'root:0'; kernelLogs = 'Boot:Success'; bootSector = 'HFS+'; shadowCopy = 'N/A'; hypervisor = 'N/A'; }
        else if (ua.includes('10_11')) { version = 'El Capitan'; build = '15A284'; edition = 'N/A'; kernel = '15.0.0'; hotfixes = 'N/A'; tpm = 'N/A'; secureBootKey = 'N/A'; drivers = 'mach_kernel'; uefiVars = 'N/A'; samData = 'root:0'; kernelLogs = 'Boot:Success'; bootSector = 'HFS+'; shadowCopy = 'N/A'; hypervisor = 'N/A'; }
        else if (ua.includes('10_12')) { version = 'Sierra'; build = '16A323'; edition = 'N/A'; kernel = '16.0.0'; hotfixes = 'N/A'; tpm = 'N/A'; secureBootKey = 'N/A'; drivers = 'mach_kernel'; uefiVars = 'N/A'; samData = 'root:0'; kernelLogs = 'Boot:Success'; bootSector = 'APFS'; shadowCopy = 'N/A'; hypervisor = 'N/A'; }
        else if (ua.includes('10_13')) { version = 'High Sierra'; build = '17A365'; edition = 'N/A'; kernel = '17.0.0'; hotfixes = 'N/A'; tpm = 'N/A'; secureBootKey = 'N/A'; drivers = 'mach_kernel'; uefiVars = 'N/A'; samData = 'root:0'; kernelLogs = 'Boot:Success'; bootSector = 'APFS'; shadowCopy = 'N/A'; hypervisor = 'N/A'; }
        else if (ua.includes('10_14')) { version = 'Mojave'; build = '18A391'; edition = 'N/A'; kernel = '18.0.0'; hotfixes = 'N/A'; tpm = 'N/A'; secureBootKey = 'N/A'; drivers = 'mach_kernel'; uefiVars = 'N/A'; samData = 'root:0'; kernelLogs = 'Boot:Success'; bootSector = 'APFS'; shadowCopy = 'N/A'; hypervisor = 'N/A'; }
        else if (ua.includes('10_15')) { version = 'Catalina'; build = '19A583'; edition = 'N/A'; kernel = '19.0.0'; hotfixes = 'N/A'; tpm = 'N/A'; secureBootKey = 'N/A'; drivers = 'mach_kernel'; uefiVars = 'N/A'; samData = 'root:0'; kernelLogs = 'Boot:Success'; bootSector = 'APFS'; shadowCopy = 'N/A'; hypervisor = 'N/A'; }
        else if (ua.includes('11')) { version = 'Big Sur'; build = '20A2411'; edition = 'N/A'; kernel = '20.0.0'; hotfixes = 'N/A'; tpm = 'N/A'; secureBootKey = 'N/A'; drivers = 'mach_kernel'; uefiVars = 'N/A'; samData = 'root:0'; kernelLogs = 'Boot:Success'; bootSector = 'APFS'; shadowCopy = 'N/A'; hypervisor = 'N/A'; }
        else if (ua.includes('12')) { version = 'Monterey'; build = '21A559'; edition = 'N/A'; kernel = '21.0.0'; hotfixes = 'N/A'; tpm = 'N/A'; secureBootKey = 'N/A'; drivers = 'mach_kernel'; uefiVars = 'N/A'; samData = 'root:0'; kernelLogs = 'Boot:Success'; bootSector = 'APFS'; shadowCopy = 'N/A'; hypervisor = 'N/A'; }
        else if (ua.includes('13')) { version = 'Ventura'; build = '22A380'; edition = 'N/A'; kernel = '22.0.0'; hotfixes = 'N/A'; tpm = 'N/A'; secureBootKey = 'N/A'; drivers = 'mach_kernel'; uefiVars = 'N/A'; samData = 'root:0'; kernelLogs = 'Boot:Success'; bootSector = 'APFS'; shadowCopy = 'N/A'; hypervisor = 'N/A'; }
        else if (ua.includes('14')) { version = 'Sonoma'; build = '23A344'; edition = 'N/A'; kernel = '23.0.0'; hotfixes = 'N/A'; tpm = 'N/A'; secureBootKey = 'N/A'; drivers = 'mach_kernel'; uefiVars = 'N/A'; samData = 'root:0'; kernelLogs = 'Boot:Success'; bootSector = 'APFS'; shadowCopy = 'N/A'; hypervisor = 'N/A'; }
      } else if (ua.includes('linux')) {
        os = 'Linux';
        if (ua.includes('ubuntu')) { version = 'Ubuntu 24.04'; build = 'N/A'; edition = 'Noble Numbat'; kernel = '6.8.0'; hotfixes = 'N/A'; tpm = '2.0 Enabled'; secureBootKey = 'N/A'; drivers = 'vmlinuz-6.8.0'; uefiVars = 'SecureBoot=1'; samData = 'root:0'; kernelLogs = 'Boot:Success'; bootSector = 'ext4'; shadowCopy = 'N/A'; hypervisor = 'KVM:Disabled'; }
        else if (ua.includes('debian')) { version = 'Debian 12'; build = 'N/A'; edition = 'Bookworm'; kernel = '6.1.0'; hotfixes = 'N/A'; tpm = '2.0 Enabled'; secureBootKey = 'N/A'; drivers = 'vmlinuz-6.1.0'; uefiVars = 'SecureBoot=1'; samData = 'root:0'; kernelLogs = 'Boot:Success'; bootSector = 'ext4'; shadowCopy = 'N/A'; hypervisor = 'KVM:Disabled'; }
        else if (ua.includes('fedora')) { version = 'Fedora 40'; build = 'N/A'; edition = 'Workstation'; kernel = '6.9.0'; hotfixes = 'N/A'; tpm = '2.0 Enabled'; secureBootKey = 'N/A'; drivers = 'vmlinuz-6.9.0'; uefiVars = 'SecureBoot=1'; samData = 'root:0'; kernelLogs = 'Boot:Success'; bootSector = 'ext4'; shadowCopy = 'N/A'; hypervisor = 'KVM:Disabled'; }
        else if (ua.includes('centos')) { version = 'CentOS 8'; build = 'N/A'; edition = 'Stream'; kernel = '4.18.0'; hotfixes = 'N/A'; tpm = '2.0 Enabled'; secureBootKey = 'N/A'; drivers = 'vmlinuz-4.18.0'; uefiVars = 'SecureBoot=1'; samData = 'root:0'; kernelLogs = 'Boot:Success'; bootSector = 'ext4'; shadowCopy = 'N/A'; hypervisor = 'KVM:Disabled'; }
        else if (ua.includes('rhel')) { version = 'RHEL 9'; build = 'N/A'; edition = 'Server'; kernel = '5.14.0'; hotfixes = 'N/A'; tpm = '2.0 Enabled'; secureBootKey = 'N/A'; drivers = 'vmlinuz-5.14.0'; uefiVars = 'SecureBoot=1'; samData = 'root:0'; kernelLogs = 'Boot:Success'; bootSector = 'ext4'; shadowCopy = 'N/A'; hypervisor = 'KVM:Disabled'; }
        else if (ua.includes('suse')) { version = 'openSUSE 15.5'; build = 'N/A'; edition = 'Leap'; kernel = '5.14.21'; hotfixes = 'N/A'; tpm = '2.0 Enabled'; secureBootKey = 'N/A'; drivers = 'vmlinuz-5.14.21'; uefiVars = 'SecureBoot=1'; samData = 'root:0'; kernelLogs = 'Boot:Success'; bootSector = 'ext4'; shadowCopy = 'N/A'; hypervisor = 'KVM:Disabled'; }
      } else if (ua.includes('cros')) {
        os = 'ChromeOS';
        version = '128.0.6613.84'; build = 'N/A'; edition = 'Stable'; kernel = '5.15.0'; hotfixes = 'N/A'; tpm = '2.0 Enabled'; secureBootKey = 'N/A'; drivers = 'chromeos-kernel'; uefiVars = 'SecureBoot=1'; samData = 'chronos:1000'; kernelLogs = 'Boot:Success'; bootSector = 'ext4'; shadowCopy = 'N/A'; hypervisor = 'N/A';
      }
      osInfoSpan.textContent = `${os} ${version} (Build: ${build}, Edition: ${edition}, Kernel: ${kernel}, Hotfixes: ${hotfixes}, TPM: ${tpm}, SecureBootKey: ${secureBootKey}, Drivers: ${drivers}, UEFI Vars: ${uefiVars}, SAM: ${samData}, Kernel Logs: ${kernelLogs}, Boot Sector: ${bootSector}, Shadow Copy: ${shadowCopy}, Hypervisor: ${hypervisor})`;
      deviceProfile.os = os;
      deviceProfile.version = version;
      deviceProfile.build = build;
      deviceProfile.edition = edition;
      deviceProfile.kernel = kernel;
      deviceProfile.hotfixes = hotfixes;
      deviceProfile.tpm = tpm;
      deviceProfile.secureBootKey = secureBootKey;
      deviceProfile.drivers = drivers;
      deviceProfile.uefiVars = uefiVars;
      deviceProfile.samData = samData;
      deviceProfile.kernelLogs = kernelLogs;
      deviceProfile.bootSector = bootSector;
      deviceProfile.shadowCopy = shadowCopy;
      deviceProfile.hypervisor = hypervisor;
    }
    function scanDeviceFallback(profile) {
      profile.cores = 16;
      profile.memory = 8;
      profile.cpu = 'Intel Core i9-12900K';
      profile.microcode = '0x1C';
      profile.stepping = 'R0';
      profile.cpuVulns = ['Spectre', 'Meltdown', 'Foreshadow', 'MDS'];
      profile.cpuCache = 'L1:384KB, L2:2MB, L3:30MB';
      profile.cpuClock = 'Base:3.2GHz, Boost:5.2GHz';
      profile.cpuTemp = '45C';
      profile.cpuDie = 'Alder Lake-S, 10nm';
      profile.gpu = 'NVIDIA RTX 3080';
      profile.gpuVram = '8GB';
      profile.gpuDrivers = 'NVIDIA 536.23';
      profile.gpuShaders = 'DirectX 12';
      profile.gpuComputeUnits = '48';
      profile.gpuClock = 'Base:1.5GHz, Boost:1.8GHz';
      profile.gpuTemp = '55C';
      profile.gpuDie = 'Ampere, 8nm';
      profile.disk = '1024GB';
      profile.diskFirmware = 'SSD v2.1';
      profile.diskSmart = 'Health:Good, Errors:0, Temp:35C';
      profile.diskSpeeds = 'Read:7000MB/s, Write:5000MB/s';
      profile.diskEncryption = 'BitLocker:Enabled';
      profile.diskRaid = 'RAID0:2xSamsung 990 Pro';
      profile.partitions = 'C:NTFS, D:exFAT, E:NTFS';
      profile.firmware = 'UEFI 2.8';
      profile.firmwareBackdoors = 'None';
      profile.biosHash = 'SHA256:deadbeef1234...';
      profile.chipset = 'Intel Z690';
      profile.motherboard = 'ASUS ROG Strix Z690-E';
      profile.tpmFirmware = '1.3.2';
      profile.battery = 'N/A (Desktop)';
      profile.fanSpeeds = 'CPU:1200RPM, GPU:1500RPM, Case:800RPM';
      profile.fanCurves = 'PWM:Linear, 30%-100%';
      profile.pciDevices = 'NIC:Intel I225-V, GPU:NVIDIA RTX 3080, USB:ASMedia ASM3142, NVMe:Samsung 990 Pro';
      profile.usbDevices = 'Mouse:Logitech G502, Keyboard:Corsair K95, Flash Drive:SanDisk 128GB';
      profile.peripherals = 'Webcam:Logitech C920, Mic:Blue Yeti, Speakers:Edifier R1280T';
      profile.securitySoftware = 'Windows Defender';
      profile.monitoringTools = 'Sysmon:Enabled, EDR:Carbon Black';
      profile.kernelModules = 'ntoskrnl.exe, hal.dll, tcpip.sys, ksecdd.sys';
      profile.kernelProtections = 'KPP:Enabled, ASLR:Enabled, SecureBoot:Enabled';
      profile.processes = 'chrome.exe, svchost.exe, explorer.exe, cron, init';
      profile.threads = 'TID:1234, TID:5678, TID:9012';
      profile.handles = 'Handle:0x123, Handle:0x456, Handle:0x789';
      profile.interrupts = 'IRQ:5, IRQ:7, IRQ:11';
      profile.memoryRegions = '0x7FFF:Passwords(Admin:Pass123!), 0x8000:Tokens(JWT:abc.xyz)';
      profile.pageTables = 'Active:1024, Inactive:512';
      profile.swapSpace = 'Used:2GB, Total:4GB';
      profile.memoryCompression = 'Enabled:LZ4';
      profile.memoryMalware = 'None';
      profile.network = { 
        status: 'Open', 
        vpn: 'Unlikely', 
        dns: 'Cloudflare', 
        gateway: '192.168.1.1', 
        mtu: '1500', 
        routerFirmware: 'ASUS RT-AX88U v3.0.0.4', 
        hiddenTunnels: 'None', 
        switchInfo: 'TP-Link TL-SG108', 
        ip: '192.168.1.101', 
        proxy: 'None', 
        packetInjection: 'Active',
        arpTable: '192.168.1.1:00:1A:2B:3C:4D:5E, 192.168.1.100:00:1B:2C:3D:4E:5F',
        connections: 'TCP:192.168.1.101:443->1.1.1.1:HTTPS, UDP:192.168.1.101:53->1.1.1.1:DNS',
        ports: '80:Open, 443:Open, 445:Filtered',
        vlan: 'VLAN10:Enabled',
        qos: 'Priority:High (VoIP), Low (Torrent)',
        latency: '15ms',
        nearbyDevices: '192.168.1.100 (SmartTV), 192.168.1.102 (Laptop)',
        interceptedPackets: 'HTTP:GET /login, HTTPS:TLS Handshake'
      };
      profile.fakeHardware = 'Spoofed:CPU-Z, GPU-Z';
      profile.logNoise = 'Injected:1000 fake entries';
      profile.networkNoise = 'Injected:Random UDP packets';
      profile.cryptoKeys = 'RSA:2048-bit (PrivKey:deadbeef...), AES:256-bit (Key:1234abcd...)';
      profile.cookies = 'SessionID:abc123, AuthToken:xyz789';
      profile.clipboard = 'LastCopied:CreditCard:1234-5678-9012-3456';
      profile.fingerprint = btoa(`${profile.cores}-${profile.memory}-${profile.cpu}-${profile.gpu}-${Date.now()}`).slice(0, 16);
      profile.macAddress = '00:1A:2B:3C:4D:5E';
      profile.isSandbox = 'Clean';
      deviceProfile = profile;
      scanCache.set('latest', deviceProfile);
      systemScanSpan.textContent = `CPU: ${deviceProfile.cpu} (${deviceProfile.cores} cores, Microcode: ${deviceProfile.microcode}, Stepping: ${deviceProfile.stepping}, Vulns: ${deviceProfile.cpuVulns.join(',')}, Cache: ${deviceProfile.cpuCache}, Clock: ${deviceProfile.cpuClock}, Temp: ${deviceProfile.cpuTemp}, Die: ${deviceProfile.cpuDie}) | Memory: ${deviceProfile.memory}GB (Regions: ${deviceProfile.memoryRegions}, Page Tables: ${deviceProfile.pageTables}, Swap: ${deviceProfile.swapSpace}, Compression: ${deviceProfile.memoryCompression}, Malware: ${deviceProfile.memoryMalware}) | GPU: ${deviceProfile.gpu} (VRAM: ${deviceProfile.gpuVram}, Drivers: ${deviceProfile.gpuDrivers}, Shaders: ${deviceProfile.gpuShaders}, Compute Units: ${deviceProfile.gpuComputeUnits}, Clock: ${deviceProfile.gpuClock}, Temp: ${deviceProfile.gpuTemp}, Die: ${deviceProfile.gpuDie}) | Disk: ${deviceProfile.disk} (Firmware: ${deviceProfile.diskFirmware}, SMART: ${deviceProfile.diskSmart}, Speeds: ${deviceProfile.diskSpeeds}, Encryption: ${deviceProfile.diskEncryption}, RAID: ${deviceProfile.diskRaid}, Partitions: ${deviceProfile.partitions}) | Firmware: ${deviceProfile.firmware} (Backdoors: ${deviceProfile.firmwareBackdoors}, BIOS Hash: ${deviceProfile.biosHash}) | Chipset: ${deviceProfile.chipset} | Motherboard: ${deviceProfile.motherboard} | TPM Firmware: ${deviceProfile.tpmFirmware} | Battery: ${deviceProfile.battery} | Fan Speeds: ${deviceProfile.fanSpeeds} (Curves: ${deviceProfile.fanCurves}) | PCI Devices: ${deviceProfile.pciDevices} | USB Devices: ${deviceProfile.usbDevices} | Peripherals: ${deviceProfile.peripherals} | Security: ${deviceProfile.securitySoftware} | Monitoring: ${deviceProfile.monitoringTools} | Kernel Modules: ${deviceProfile.kernelModules} | Kernel Protections: ${deviceProfile.kernelProtections} | Processes: ${deviceProfile.processes} | Threads: ${deviceProfile.threads} | Handles: ${deviceProfile.handles} | Interrupts: ${deviceProfile.interrupts} | Network: ${deviceProfile.network.status} (VPN: ${deviceProfile.network.vpn}, DNS: ${deviceProfile.network.dns}, Gateway: ${deviceProfile.network.gateway}, MTU: ${deviceProfile.network.mtu}, Router: ${deviceProfile.network.routerFirmware}, Tunnels: ${deviceProfile.network.hiddenTunnels}, Switch: ${deviceProfile.network.switchInfo}, IP: ${deviceProfile.network.ip}, Proxy: ${deviceProfile.network.proxy}, Injection: ${deviceProfile.network.packetInjection}, ARP: ${deviceProfile.network.arpTable}, Connections: ${deviceProfile.network.connections}, Ports: ${deviceProfile.network.ports}, VLAN: ${deviceProfile.network.vlan}, QoS: ${deviceProfile.network.qos}, Latency: ${deviceProfile.network.latency}, Nearby: ${deviceProfile.network.nearbyDevices}, Packets: ${deviceProfile.network.interceptedPackets}) | Anti-Detection: FakeHW:${deviceProfile.fakeHardware}, LogNoise:${deviceProfile.logNoise}, NetNoise:${deviceProfile.networkNoise} | Crypto Keys: ${deviceProfile.cryptoKeys} | Cookies: ${deviceProfile.cookies} | Clipboard: ${deviceProfile.clipboard} | Sandbox: ${deviceProfile.isSandbox}`;
      detectionRisk = 'None';
      updateStatusBar();
    }

    async function scanDevice() {
      if (scanCache.has('latest')) {
        deviceProfile = scanCache.get('latest');
        systemScanSpan.textContent = `CPU: ${deviceProfile.cpu} (${deviceProfile.cores} cores, Microcode: ${deviceProfile.microcode}, Stepping: ${deviceProfile.stepping}, Vulns: ${deviceProfile.cpuVulns.join(',')}, Cache: ${deviceProfile.cpuCache}, Clock: ${deviceProfile.cpuClock}, Temp: ${deviceProfile.cpuTemp}, Die: ${deviceProfile.cpuDie}) | Memory: ${deviceProfile.memory}GB (Regions: ${deviceProfile.memoryRegions}, Page Tables: ${deviceProfile.pageTables}, Swap: ${deviceProfile.swapSpace}, Compression: ${deviceProfile.memoryCompression}, Malware: ${deviceProfile.memoryMalware}) | GPU: ${deviceProfile.gpu} (VRAM: ${deviceProfile.gpuVram}, Drivers: ${deviceProfile.gpuDrivers}, Shaders: ${deviceProfile.gpuShaders}, Compute Units: ${deviceProfile.gpuComputeUnits}, Clock: ${deviceProfile.gpuClock}, Temp: ${deviceProfile.gpuTemp}, Die: ${deviceProfile.gpuDie}) | Disk: ${deviceProfile.disk} (Firmware: ${deviceProfile.diskFirmware}, SMART: ${deviceProfile.diskSmart}, Speeds: ${deviceProfile.diskSpeeds}, Encryption: ${deviceProfile.diskEncryption}, RAID: ${deviceProfile.diskRaid}, Partitions: ${deviceProfile.partitions}) | Firmware: ${deviceProfile.firmware} (Backdoors: ${deviceProfile.firmwareBackdoors}, BIOS Hash: ${deviceProfile.biosHash}) | Chipset: ${deviceProfile.chipset} | Motherboard: ${deviceProfile.motherboard} | TPM Firmware: ${deviceProfile.tpmFirmware} | Battery: ${deviceProfile.battery} | Fan Speeds: ${deviceProfile.fanSpeeds} (Curves: ${deviceProfile.fanCurves}) | PCI Devices: ${deviceProfile.pciDevices} | USB Devices: ${deviceProfile.usbDevices} | Peripherals: ${deviceProfile.peripherals} | Security: ${deviceProfile.securitySoftware} | Monitoring: ${deviceProfile.monitoringTools} | Kernel Modules: ${deviceProfile.kernelModules} | Kernel Protections: ${deviceProfile.kernelProtections} | Processes: ${deviceProfile.processes} | Threads: ${deviceProfile.threads} | Handles: ${deviceProfile.handles} | Interrupts: ${deviceProfile.interrupts} | Network: ${deviceProfile.network.status} (VPN: ${deviceProfile.network.vpn}, DNS: ${deviceProfile.network.dns}, Gateway: ${deviceProfile.network.gateway}, MTU: ${deviceProfile.network.mtu}, Router: ${deviceProfile.network.routerFirmware}, Tunnels: ${deviceProfile.network.hiddenTunnels}, Switch: ${deviceProfile.network.switchInfo}, IP: ${deviceProfile.network.ip}, Proxy: ${deviceProfile.network.proxy}, Injection: ${deviceProfile.network.packetInjection}, ARP: ${deviceProfile.network.arpTable}, Connections: ${deviceProfile.network.connections}, Ports: ${deviceProfile.network.ports}, VLAN: ${deviceProfile.network.vlan}, QoS: ${deviceProfile.network.qos}, Latency: ${deviceProfile.network.latency}, Nearby: ${deviceProfile.network.nearbyDevices}, Packets: ${deviceProfile.network.interceptedPackets}) | Anti-Detection: FakeHW:${deviceProfile.fakeHardware}, LogNoise:${deviceProfile.logNoise}, NetNoise:${deviceProfile.networkNoise} | Crypto Keys: ${deviceProfile.cryptoKeys} | Cookies: ${deviceProfile.cookies} | Clipboard: ${deviceProfile.clipboard} | Sandbox: ${deviceProfile.isSandbox}`;
        updateStatusBar();
        return;
      }

      return new Promise((resolve) => {
        if (scanWorker.postMessage) {
          scanWorker.onmessage = (e) => {
            deviceProfile = e.data.deviceProfile;
            scanCache.set('latest', deviceProfile);
            systemScanSpan.textContent = `CPU: ${deviceProfile.cpu} (${deviceProfile.cores} cores, Microcode: ${deviceProfile.microcode}, Stepping: ${deviceProfile.stepping}, Vulns: ${deviceProfile.cpuVulns.join(',')}, Cache: ${deviceProfile.cpuCache}, Clock: ${deviceProfile.cpuClock}, Temp: ${deviceProfile.cpuTemp}, Die: ${deviceProfile.cpuDie}) | Memory: ${deviceProfile.memory}GB (Regions: ${deviceProfile.memoryRegions}, Page Tables: ${deviceProfile.pageTables}, Swap: ${deviceProfile.swapSpace}, Compression: ${deviceProfile.memoryCompression}, Malware: ${deviceProfile.memoryMalware}) | GPU: ${deviceProfile.gpu} (VRAM: ${deviceProfile.gpuVram}, Drivers: ${deviceProfile.gpuDrivers}, Shaders: ${deviceProfile.gpuShaders}, Compute Units: ${deviceProfile.gpuComputeUnits}, Clock: ${deviceProfile.gpuClock}, Temp: ${deviceProfile.gpuTemp}, Die: ${deviceProfile.gpuDie}) | Disk: ${deviceProfile.disk} (Firmware: ${deviceProfile.diskFirmware}, SMART: ${deviceProfile.diskSmart}, Speeds: ${deviceProfile.diskSpeeds}, Encryption: ${deviceProfile.diskEncryption}, RAID: ${deviceProfile.diskRaid}, Partitions: ${deviceProfile.partitions}) | Firmware: ${deviceProfile.firmware} (Backdoors: ${deviceProfile.firmwareBackdoors}, BIOS Hash: ${deviceProfile.biosHash}) | Chipset: ${deviceProfile.chipset} | Motherboard: ${deviceProfile.motherboard} | TPM Firmware: ${deviceProfile.tpmFirmware} | Battery: ${deviceProfile.battery} | Fan Speeds: ${deviceProfile.fanSpeeds} (Curves: ${deviceProfile.fanCurves}) | PCI Devices: ${deviceProfile.pciDevices} | USB Devices: ${deviceProfile.usbDevices} | Peripherals: ${deviceProfile.peripherals} | Security: ${deviceProfile.securitySoftware} | Monitoring: ${deviceProfile.monitoringTools} | Kernel Modules: ${deviceProfile.kernelModules} | Kernel Protections: ${deviceProfile.kernelProtections} | Processes: ${deviceProfile.processes} | Threads: ${deviceProfile.threads} | Handles: ${deviceProfile.handles} | Interrupts: ${deviceProfile.interrupts} | Network: ${deviceProfile.network.status} (VPN: ${deviceProfile.network.vpn}, DNS: ${deviceProfile.network.dns}, Gateway: ${deviceProfile.network.gateway}, MTU: ${deviceProfile.network.mtu}, Router: ${deviceProfile.network.routerFirmware}, Tunnels: ${deviceProfile.network.hiddenTunnels}, Switch: ${deviceProfile.network.switchInfo}, IP: ${deviceProfile.network.ip}, Proxy: ${deviceProfile.network.proxy}, Injection: ${deviceProfile.network.packetInjection}, ARP: ${deviceProfile.network.arpTable}, Connections: ${deviceProfile.network.connections}, Ports: ${deviceProfile.network.ports}, VLAN: ${deviceProfile.network.vlan}, QoS: ${deviceProfile.network.qos}, Latency: ${deviceProfile.network.latency}, Nearby: ${deviceProfile.network.nearbyDevices}, Packets: ${deviceProfile.network.interceptedPackets}) | Anti-Detection: FakeHW:${deviceProfile.fakeHardware}, LogNoise:${deviceProfile.logNoise}, NetNoise:${deviceProfile.networkNoise} | Crypto Keys: ${deviceProfile.cryptoKeys} | Cookies: ${deviceProfile.cookies} | Clipboard: ${deviceProfile.clipboard} | Sandbox: ${deviceProfile.isSandbox}`;
            detectionRisk = 'None';
            updateStatusBar();
            resolve();
          };
          scanWorker.postMessage({ deviceProfile });
        } else {
          scanDeviceFallback(deviceProfile);
          resolve();
        }
      });
    }

    function generateObfuscatedKey() {
      const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
      let key = '';
      for (let i = 0; i < 32; i++) {
        key += chars.charAt(Math.floor(Math.random() * chars.length));
      }
      return `${key}_${deviceProfile.fingerprint}_${Math.random().toString(36).slice(2, 16)}`;
    }

    function aiSelectStrategy() {
      const persistence = (function() {
        if (deviceProfile.os === 'Windows' && deviceProfile.version === 'XP') return 'registry';
        if (deviceProfile.os === 'Windows' && deviceProfile.version === 'Vista') return 'autorun';
        if (deviceProfile.os === 'Windows' && deviceProfile.version === '7') return 'wmi';
        if (deviceProfile.os === 'Windows' && deviceProfile.version === '8') return 'scheduled_task';
        if (deviceProfile.os === 'Windows' && (deviceProfile.version === '10' || deviceProfile.version === '11')) return 'rootkit';
        if (deviceProfile.os === 'macOS' && deviceProfile.version === 'Tiger') return 'startup_items';
        if (deviceProfile.os === 'macOS' && deviceProfile.version === 'Leopard') return 'launchd';
        if (deviceProfile.os === 'macOS' && deviceProfile.version >= 'Sierra') return 'login_items';
        if (deviceProfile.os === 'Linux') return 'cron';
        if (deviceProfile.os === 'ChromeOS') return 'crontab';
        return 'wmi';
      })();

      const obfuscation = (function() {
        if (deviceProfile.os === 'Windows' && deviceProfile.version === 'XP') return 'msfencode';
        if (deviceProfile.os === 'Windows' && deviceProfile.version >= 'Vista') return 'veil';
        if (deviceProfile.os === 'macOS' && deviceProfile.version <= 'Mavericks') return 'mach-o_strip';
        if (deviceProfile.os === 'macOS' && deviceProfile.version >= 'Yosemite') return 'codesign';
        if (deviceProfile.os === 'Linux') return 'upx';
        if (deviceProfile.os === 'ChromeOS') return 'strip';
        return 'veil';
      })();

      const exploitChain = (function() {
        if (deviceProfile.os === 'Windows' && deviceProfile.version === 'XP') return 'MS03-026 -> MS08-067';
        if (deviceProfile.os === 'Windows' && deviceProfile.version === '7') return 'CVE-2015-1635 -> CVE-2017-0144';
        if (deviceProfile.os === 'Windows' && deviceProfile.version === '10') return 'CVE-2021-40449 -> CVE-2022-41082';
        if (deviceProfile.os === 'macOS' && deviceProfile.version === 'High Sierra') return 'CVE-2017-13872';
        if (deviceProfile.os === 'macOS' && deviceProfile.version === 'Big Sur') return 'CVE-2021-30869';
        if (deviceProfile.os === 'Linux' && deviceProfile.version.includes('Ubuntu')) return 'CVE-2021-4034';
        if (deviceProfile.os === 'ChromeOS') return 'CVE-2023-6345';
        return 'CVE-2021-4034';
      })();

      return { persistence, obfuscation, exploitChain };
    }

    async function processCommand() {
      const input = extensionIdInput.value.trim().toLowerCase();
      extensionIdInput.value = '';
      if (!input) return;
      commandHistory.push(input);
      historyIndex = commandHistory.length;

      addCommand(`> ${input}`);
      if (clickSound.play) clickSound.play();

      await scanDevice();

      if (input.startsWith('toggle ')) {
        const extId = input.split(' ')[1];
        if (!extId || extId.length !== 32 || !/^[a-z0-9]+$/.test(extId)) {
          addCommand('Error: Invalid extension ID. Must be 32 chars (a-z, 0-9).', 'error');
          detectionRisk = 'Low';
          aiConfidence = 0.9;
          updateStatusBar();
          return;
        }

        if (!knownExtensionIds.includes(extId)) {
          addCommand(`Error: Extension ${extId} not found in target system.`, 'error');
          detectionRisk = 'Low';
          aiConfidence = 0.85;
          updateStatusBar();
          return;
        }

        const strategy = aiSelectStrategy();
        addCommand(`Toggling extension ${extId}...`);
        addCommand(`Persistence: ${strategy.persistence} | Obfuscation: ${strategy.obfuscation} | Exploit Chain: ${strategy.exploitChain}`);
        addCommand(`Injecting payload... Key: ${generateObfuscatedKey()}`);
        addCommand(`Success: Extension ${extId} toggled. Status: ${Math.random() > 0.5 ? 'Enabled' : 'Disabled'}`, 'success');
        detectionRisk = 'Minimal';
        aiConfidence = 0.98;
      } else if (input === 'selfdestruct') {
        addCommand('Initiating self-destruct sequence...');
        addCommand('Erasing traces...');
        if (deviceProfile.os === 'Windows' && deviceProfile.bootSector.includes('FAT32')) {
          addCommand('Shredding FAT32 remnants...');
        } else if (deviceProfile.os === 'macOS' && deviceProfile.bootSector === 'APFS') {
          addCommand('Wiping APFS snapshots...');
        } else if (deviceProfile.os === 'Linux') {
          addCommand('Overwriting ext4 inodes...');
        }
        addCommand('Success: All traces eliminated.', 'success');
        detectionRisk = 'None';
        aiConfidence = 1.0;
        commandHistory = [];
        historyIndex = -1;
        terminalContent.innerHTML = '<div class="command">System reset. Ready for new commands.</div>';
      } else if (input === 'help') {
        addCommand('Available commands:');
        addCommand('  toggle [ext_id] - Toggle extension state (e.g., toggle pganeibhckoanndahmnfggfoeofncnii)');
        addCommand('  selfdestruct    - Erase all traces and reset');
        addCommand('  help            - Show this help message');
        detectionRisk = 'None';
        aiConfidence = 1.0;
      } else {
        addCommand(`Error: Unknown command "${input}". Type "help" for commands.`, 'error');
        detectionRisk = 'Low';
        aiConfidence = 0.95;
      }
      updateStatusBar();
    }

    extensionIdInput.addEventListener('keydown', (e) => {
      if (e.key === 'Enter') {
        processCommand();
      } else if (e.key === 'ArrowUp') {
        if (historyIndex > 0) {
          historyIndex--;
          extensionIdInput.value = commandHistory[historyIndex] || '';
        }
        e.preventDefault();
      } else if (e.key === 'ArrowDown') {
        if (historyIndex < commandHistory.length - 1) {
          historyIndex++;
          extensionIdInput.value = commandHistory[historyIndex] || '';
        } else {
          historyIndex = commandHistory.length;
          extensionIdInput.value = '';
        }
        e.preventDefault();
      }
    });

    detectOS();
    scanDevice();
  </script>
</body>
</html>
